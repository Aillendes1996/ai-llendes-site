/* AI-llendes – Language switch (EN/FR) */

// 1) Full dictionary: covers all data-i18n keys in your HTML
const I18N = {
  en: {
    brand: "AI-llendes",

    // nav
    nav_what: "What We Do",
    nav_faq: "FAQ",
    nav_book: "Book a Call",

    // hero
    hero_h1: "Stop Losing Leads to Slow Replies",
    hero_p:
      "We capture new inquiries and reply in <strong>&lt;60s</strong> over SMS/email/WhatsApp, qualifying and driving them straight to your calendar — 24/7.",
    cta_primary: "Get More Booked Calls",
    cta_secondary: "See How It Works",
    bullet_1: "Average first response < 30 seconds",
    bullet_2: "Show-up rates 20–40% higher",
    bullet_3: "Works with your CRM, forms, and ads",
    stat_more_calls: "More booked calls",
    chat_1: "New lead captured ✅",
    chat_2: "Hey! Want to chat this week?",
    chat_3: "Great — calendar link below 📅",

    // what we do
    what_title: "What We Do",
    what_sub: "Capture → Respond → Book. Fully automated, fully logged.",
    card1_h: "🚀 Instant Outreach",
    card1_p:
      "Auto-respond over SMS, email, and WhatsApp within seconds of form fills, DMs, or inbound calls.",
    card2_h: "🤝 2-Way Nurture",
    card2_p:
      "Human-like sequences qualify, answer FAQs, and overcome objections—no manual chasing.",
    card3_h: "📅 Autopilot Booking",
    card3_p:
      "Push qualified leads to your calendar, with reminders and rescheduling handled automatically.",
    card4_h: "⏳ Save Time",
    card4_p:
      "We automate the busywork so you focus on closing—no more inbox ping-pong.",
    card5_h: "♻️ Revive Dead Leads",
    card5_p:
      "Smart follow-ups re-engage stale or ghosted leads and bring lost revenue back to life.",
    card6_h: "🔌 Your Stack",
    card6_p:
      "Google/Outlook calendars, HubSpot/Salesforce/Pipedrive, Meta/Google Ads forms, Typeform, Zapier—plug and play.",

    // commitments
    commit_title: "Our Commitments",
    commit1_h: "Sub-60s First Touch",
    commit1_p: "Every qualified lead hears from you in under a minute, 24/7.",
    commit2_h: "White-Glove Setup",
    commit2_p: "We integrate your CRM, ads, and calendar—done for you.",
    commit3_h: "Revenue-First",
    commit3_p: "Optimized for booked revenue calls, not just replies.",
    commit4_h: "Privacy & Compliance",
    commit4_p:
      "Consent-aware messaging with clear opt-outs and data controls.",

    // stats strip
    stat_1: "Avg Response Time",
    stat_2: "Always On",
    stat_3: "After-Hours Engagement",
    stat_4: "Booking Rate (mins)",

    // faq
    faq_title: "FAQ",
    faq1_q: "How fast are replies really?",
    faq1_a:
      "We target 15–60 seconds from capture to first message, 24/7. Most clients see ~30 seconds.",
    faq2_q: "Will this work with my existing tools?",
    faq2_a:
      "Yes—CRMs, calendars, forms, and ad platforms. If you have an API or Zapier, we can connect.",
    faq3_q: "How do you handle compliance and opt-outs?",
    faq3_a:
      "We include consent capture, clear opt-out flows, and respect regional regulations.",
    faq4_q: "What does onboarding look like?",
    faq4_a:
      "Strategy call, workflows defined, integrations connected, sequences launched—typically in 7–10 days.",
    faq5_q: "Do you offer a money-back/results guarantee?",
    faq5_a:
      "Yes. If we don’t meet the outcomes agreed on our kickoff call in the first 30 days after go-live (given agreed inputs like ad spend, list quality, and form placement), we won’t bill the monthly fee for that period. We either fix it together or pause—your choice.",

    // booking
    book_title: "Book a Call",
    book_p:
      "Pick a time that works, or leave your info and we’ll confirm via SMS/email.",
    book_left_h: "Direct calendar link",
    book_left_p: "Already ready? Jump straight to the calendar.",
    book_left_btn: "Open Calendar",
    book_left_note: "We’ll use your Calendly link from",
    book_right_h: "Request a booking",

    // form
    form_name: "Name",
    form_email: "Email",
    form_phone: "Phone",
    form_company: "Company",
    form_notes: "What are you looking to improve?",
    form_btn: "Request a Time",

    // footer
    footer_tag: "We reply in seconds and book calls on autopilot.",
    rights: "All rights reserved."
  },

  fr: {
    brand: "AI-llendes",

    // nav
    nav_what: "Ce que nous faisons",
    nav_faq: "FAQ",
    nav_book: "Réserver un appel",

    // hero
    hero_h1: "Arrêtez de perdre des prospects à cause de réponses lentes",
    hero_p:
      "Nous capturons les nouvelles demandes et répondons en <strong>&lt;60s</strong> par SMS/email/WhatsApp, en les qualifiant et en les envoyant directement dans votre agenda — 24/7.",
    cta_primary: "Obtenez plus d’appels réservés",
    cta_secondary: "Voir comment ça marche",
    bullet_1: "Première réponse moyenne < 30 secondes",
    bullet_2: "Taux de présence 20–40% plus élevé",
    bullet_3: "Fonctionne avec votre CRM, formulaires et publicités",
    stat_more_calls: "Plus d’appels réservés",
    chat_1: "Nouveau prospect capturé ✅",
    chat_2: "Salut ! Veux-tu discuter cette semaine ?",
    chat_3: "Super — lien calendrier ci-dessous 📅",

    // what we do
    what_title: "Ce que nous faisons",
    what_sub: "Capturer → Répondre → Réserver. Entièrement automatisé et journalisé.",
    card1_h: "🚀 Réponse instantanée",
    card1_p:
      "Réponse automatique par SMS, email et WhatsApp en quelques secondes après un formulaire, un DM ou un appel entrant.",
    card2_h: "🤝 Nurturing à deux sens",
    card2_p:
      "Des séquences humaines qualifient, répondent aux FAQ et lèvent les objections—sans suivi manuel.",
    card3_h: "📅 Réservation automatique",
    card3_p:
      "Envoie les prospects qualifiés dans votre agenda avec rappels et replanifications automatiques.",
    card4_h: "⏳ Gain de temps",
    card4_p:
      "Nous automatisons les tâches répétitives pour que vous puissiez conclure—plus de ping-pong d’emails.",
    card5_h: "♻️ Relancer les prospects perdus",
    card5_p:
      "Des relances intelligentes réengagent les prospects inactifs ou perdus et ramènent des revenus.",
    card6_h: "🔌 Votre stack",
    card6_p:
      "Google/Outlook, HubSpot/Salesforce/Pipedrive, Meta/Google Ads, Typeform, Zapier—plug and play.",

    // commitments
    commit_title: "Nos engagements",
    commit1_h: "Premier contact en moins de 60s",
    commit1_p: "Chaque prospect qualifié a une réponse en moins d’une minute, 24/7.",
    commit2_h: "Mise en place clé en main",
    commit2_p: "Nous intégrons votre CRM, vos publicités et votre agenda—fait pour vous.",
    commit3_h: "Priorité au revenu",
    commit3_p:
      "Optimisé pour des appels générateurs de revenu, pas seulement des réponses.",
    commit4_h: "Confidentialité & conformité",
    commit4_p:
      "Messages conformes avec opt-out clair et contrôle des données.",

    // stats strip
    stat_1: "Temps de réponse moyen",
    stat_2: "Toujours actif",
    stat_3: "Engagement hors horaires",
    stat_4: "Taux de réservation (minutes)",

    // faq
    faq_title: "FAQ",
    faq1_q: "À quelle vitesse répondez-vous vraiment ?",
    faq1_a:
      "Nous visons 15–60 secondes entre la capture et le premier message, 24/7. La plupart des clients voient ~30 secondes.",
    faq2_q: "Est-ce compatible avec mes outils existants ?",
    faq2_a:
      "Oui—CRMs, agendas, formulaires et plateformes publicitaires. Avec une API ou Zapier, on peut se connecter.",
    faq3_q: "Comment gérez-vous la conformité et les désabonnements ?",
    faq3_a:
      "Nous incluons la capture du consentement, des flux d’opt-out clairs et respectons les règles régionales.",
    faq4_q: "À quoi ressemble l’onboarding ?",
    faq4_a:
      "Appel stratégique, workflows définis, intégrations connectées, séquences lancées—en 7–10 jours typiquement.",
    faq5_q: "Offrez-vous une garantie de remboursement/résultats ?",
    faq5_a:
      "Oui. Si nous ne respectons pas les résultats convenus lors de l’appel de démarrage dans les 30 premiers jours (selon les entrées convenues comme le budget pub, la qualité des listes, l’emplacement des formulaires), nous ne facturons pas le mois. On corrige ensemble ou on met en pause—à vous de choisir.",

    // booking
    book_title: "Réserver un appel",
    book_p:
      "Choisissez un moment qui vous convient, ou laissez vos infos et nous confirmerons par SMS/email.",
    book_left_h: "Lien direct calendrier",
    book_left_p: "Déjà prêt ? Passez directement au calendrier.",
    book_left_btn: "Ouvrir le calendrier",
    book_left_note: "Nous utiliserons votre lien Calendly depuis",
    book_right_h: "Demander une réservation",

    // form
    form_name: "Nom",
    form_email: "Email",
    form_phone: "Téléphone",
    form_company: "Entreprise",
    form_notes: "Que souhaitez-vous améliorer ?",
    form_btn: "Demander un horaire",

    // footer
    footer_tag:
      "Nous répondons en quelques secondes et réservons des appels en pilote automatique.",
    rights: "Tous droits réservés."
  }
};

// normalize: treat 'fr', 'FR', 'fr-CA' as French
const isFR = (v) => String(v || "").toLowerCase().startsWith("fr");


// 2) Helper: choose innerHTML only if the string contains markup
const hasHTML = (s) => /<[^>]+>/.test(s);

// 3) Apply language
function applyLang(lang) {
  try {
    const dict = I18N[ isFR(lang) ? "fr" : "en" ] || I18N.en;

    document.querySelectorAll("[data-i18n]").forEach((el) => {
      const key = el.getAttribute("data-i18n");
      const val = dict[key];
      if (val == null) return; // unknown key -> leave as is

      if (hasHTML(val)) el.innerHTML = val;
      else el.textContent = val;
    });

    // 🔑 update redirect whenever language changes
    setFormRedirect(lang);
    } catch (err) {
    console.error("applyLang error:", err);
  }
}

    // active state + document lang
    document.querySelectorAll(".lang-switch button").forEach((b) => b.classList.remove("active"));
    const btn = document.getElementById("lang-" + lang);
    if (btn) btn.classList.add("active");

    document.documentElement.setAttribute("lang", lang);
    localStorage.setItem("lang", lang);
  } catch (e) {
    console.error("Language switch error:", e);
  }
}

// 4) Wire up once DOM is parsed (defer guarantees this runs before DOMContentLoaded)
document.addEventListener("DOMContentLoaded", () => {
  // safety: sometimes pages are cached — bump the year in footer
  const yearEl = document.getElementById("year");
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  const enBtn = document.getElementById("lang-en");
  const frBtn = document.getElementById("lang-fr");

  if (enBtn) enBtn.addEventListener("click", () => applyLang("en"));
  if (frBtn) frBtn.addEventListener("click", () => applyLang("fr"));

  const initial = localStorage.getItem("lang") || "en";
  applyLang(initial);
});

// --- FAQ accordion toggle ---
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".acc__btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const isOpen = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!isOpen));
    });
  });
});

// Set Formspree _redirect based on language
function setFormRedirect(lang) {
  const redir = document.querySelector('form#bookingForm input[name="_redirect"]');
  if (!redir) return;
  // Use absolute URLs (Formspree prefers absolute redirects)
  const base = window.location.origin;
  redir.value = base + (lang === "fr" ? "/merci.html" : "/thank-you.html");
}





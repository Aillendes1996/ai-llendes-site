/* AI-llendes â€“ Language switch (EN/FR) */

// 1) Full dictionary: covers all data-i18n keys in your HTML
const I18N = {
  en: {
    brand: "AI-llendes",

    // nav
    nav_what: "What We Do",
    nav_faq: "FAQ",
    nav_book: "Book a Call",

    // hero
    hero_h1: "Stop Losing Leads to Slow Replies",
    hero_p:
      "We capture new inquiries and reply in <strong>&lt;60s</strong> over SMS/email/WhatsApp, qualifying and driving them straight to your calendar â€” 24/7.",
    cta_primary: "Get More Booked Calls",
    cta_secondary: "See How It Works",
    bullet_1: "Average first response < 30 seconds",
    bullet_2: "Show-up rates 20â€“40% higher",
    bullet_3: "Works with your CRM, forms, and ads",
    stat_more_calls: "More booked calls",
    chat_1: "New lead captured âœ…",
    chat_2: "Hey! Want to chat this week?",
    chat_3: "Great â€” calendar link below ðŸ“…",

    // what we do
    what_title: "What We Do",
    what_sub: "Capture â†’ Respond â†’ Book. Fully automated, fully logged.",
    card1_h: "ðŸš€ Instant Outreach",
    card1_p:
      "Auto-respond over SMS, email, and WhatsApp within seconds of form fills, DMs, or inbound calls.",
    card2_h: "ðŸ¤ 2-Way Nurture",
    card2_p:
      "Human-like sequences qualify, answer FAQs, and overcome objectionsâ€”no manual chasing.",
    card3_h: "ðŸ“… Autopilot Booking",
    card3_p:
      "Push qualified leads to your calendar, with reminders and rescheduling handled automatically.",
    card4_h: "â³ Save Time",
    card4_p:
      "We automate the busywork so you focus on closingâ€”no more inbox ping-pong.",
    card5_h: "â™»ï¸ Revive Dead Leads",
    card5_p:
      "Smart follow-ups re-engage stale or ghosted leads and bring lost revenue back to life.",
    card6_h: "ðŸ”Œ Your Stack",
    card6_p:
      "Google/Outlook calendars, HubSpot/Salesforce/Pipedrive, Meta/Google Ads forms, Typeform, Zapierâ€”plug and play.",

    // commitments
    commit_title: "Our Commitments",
    commit1_h: "Sub-60s First Touch",
    commit1_p: "Every qualified lead hears from you in under a minute, 24/7.",
    commit2_h: "White-Glove Setup",
    commit2_p: "We integrate your CRM, ads, and calendarâ€”done for you.",
    commit3_h: "Revenue-First",
    commit3_p: "Optimized for booked revenue calls, not just replies.",
    commit4_h: "Privacy & Compliance",
    commit4_p:
      "Consent-aware messaging with clear opt-outs and data controls.",

    // stats strip
    stat_1: "Avg Response Time",
    stat_2: "Always On",
    stat_3: "After-Hours Engagement",
    stat_4: "Booking Rate (mins)",

    // faq
    faq_title: "FAQ",
    faq1_q: "How fast are replies really?",
    faq1_a:
      "We target 15â€“60 seconds from capture to first message, 24/7. Most clients see ~30 seconds.",
    faq2_q: "Will this work with my existing tools?",
    faq2_a:
      "Yesâ€”CRMs, calendars, forms, and ad platforms. If you have an API or Zapier, we can connect.",
    faq3_q: "How do you handle compliance and opt-outs?",
    faq3_a:
      "We include consent capture, clear opt-out flows, and respect regional regulations.",
    faq4_q: "What does onboarding look like?",
    faq4_a:
      "Strategy call, workflows defined, integrations connected, sequences launchedâ€”typically in 7â€“10 days.",
    faq5_q: "Do you offer a money-back/results guarantee?",
    faq5_a:
      "Yes. If we donâ€™t meet the outcomes agreed on our kickoff call in the first 30 days after go-live (given agreed inputs like ad spend, list quality, and form placement), we wonâ€™t bill the monthly fee for that period. We either fix it together or pauseâ€”your choice.",

    // booking
    book_title: "Book a Call",
    book_p:
      "Pick a time that works, or leave your info and weâ€™ll confirm via SMS/email.",
    book_left_h: "Direct calendar link",
    book_left_p: "Already ready? Jump straight to the calendar.",
    book_left_btn: "Open Calendar",
    book_left_note: "Weâ€™ll use your Calendly link from",
    book_right_h: "Request a booking",

    // form
    form_name: "Name",
    form_email: "Email",
    form_phone: "Phone",
    form_company: "Company",
    form_notes: "What are you looking to improve?",
    form_btn: "Request a Time",

    // footer
    footer_tag: "We reply in seconds and book calls on autopilot.",
    rights: "All rights reserved."
  },

  fr: {
    brand: "AI-llendes",

    // nav
    nav_what: "Ce que nous faisons",
    nav_faq: "FAQ",
    nav_book: "RÃ©server un appel",

    // hero
    hero_h1: "ArrÃªtez de perdre des prospects Ã  cause de rÃ©ponses lentes",
    hero_p:
      "Nous capturons les nouvelles demandes et rÃ©pondons en <strong>&lt;60s</strong> par SMS/email/WhatsApp, en les qualifiant et en les envoyant directement dans votre agenda â€” 24/7.",
    cta_primary: "Obtenez plus dâ€™appels rÃ©servÃ©s",
    cta_secondary: "Voir comment Ã§a marche",
    bullet_1: "PremiÃ¨re rÃ©ponse moyenne < 30 secondes",
    bullet_2: "Taux de prÃ©sence 20â€“40% plus Ã©levÃ©",
    bullet_3: "Fonctionne avec votre CRM, formulaires et publicitÃ©s",
    stat_more_calls: "Plus dâ€™appels rÃ©servÃ©s",
    chat_1: "Nouveau prospect capturÃ© âœ…",
    chat_2: "Salut ! Veux-tu discuter cette semaine ?",
    chat_3: "Super â€” lien calendrier ci-dessous ðŸ“…",

    // what we do
    what_title: "Ce que nous faisons",
    what_sub: "Capturer â†’ RÃ©pondre â†’ RÃ©server. EntiÃ¨rement automatisÃ© et journalisÃ©.",
    card1_h: "ðŸš€ RÃ©ponse instantanÃ©e",
    card1_p:
      "RÃ©ponse automatique par SMS, email et WhatsApp en quelques secondes aprÃ¨s un formulaire, un DM ou un appel entrant.",
    card2_h: "ðŸ¤ Nurturing Ã  deux sens",
    card2_p:
      "Des sÃ©quences humaines qualifient, rÃ©pondent aux FAQ et lÃ¨vent les objectionsâ€”sans suivi manuel.",
    card3_h: "ðŸ“… RÃ©servation automatique",
    card3_p:
      "Envoie les prospects qualifiÃ©s dans votre agenda avec rappels et replanifications automatiques.",
    card4_h: "â³ Gain de temps",
    card4_p:
      "Nous automatisons les tÃ¢ches rÃ©pÃ©titives pour que vous puissiez conclureâ€”plus de ping-pong dâ€™emails.",
    card5_h: "â™»ï¸ Relancer les prospects perdus",
    card5_p:
      "Des relances intelligentes rÃ©engagent les prospects inactifs ou perdus et ramÃ¨nent des revenus.",
    card6_h: "ðŸ”Œ Votre stack",
    card6_p:
      "Google/Outlook, HubSpot/Salesforce/Pipedrive, Meta/Google Ads, Typeform, Zapierâ€”plug and play.",

    // commitments
    commit_title: "Nos engagements",
    commit1_h: "Premier contact en moins de 60s",
    commit1_p: "Chaque prospect qualifiÃ© a une rÃ©ponse en moins dâ€™une minute, 24/7.",
    commit2_h: "Mise en place clÃ© en main",
    commit2_p: "Nous intÃ©grons votre CRM, vos publicitÃ©s et votre agendaâ€”fait pour vous.",
    commit3_h: "PrioritÃ© au revenu",
    commit3_p:
      "OptimisÃ© pour des appels gÃ©nÃ©rateurs de revenu, pas seulement des rÃ©ponses.",
    commit4_h: "ConfidentialitÃ© & conformitÃ©",
    commit4_p:
      "Messages conformes avec opt-out clair et contrÃ´le des donnÃ©es.",

    // stats strip
    stat_1: "Temps de rÃ©ponse moyen",
    stat_2: "Toujours actif",
    stat_3: "Engagement hors horaires",
    stat_4: "Taux de rÃ©servation (minutes)",

    // faq
    faq_title: "FAQ",
    faq1_q: "Ã€ quelle vitesse rÃ©pondez-vous vraiment ?",
    faq1_a:
      "Nous visons 15â€“60 secondes entre la capture et le premier message, 24/7. La plupart des clients voient ~30 secondes.",
    faq2_q: "Est-ce compatible avec mes outils existants ?",
    faq2_a:
      "Ouiâ€”CRMs, agendas, formulaires et plateformes publicitaires. Avec une API ou Zapier, on peut se connecter.",
    faq3_q: "Comment gÃ©rez-vous la conformitÃ© et les dÃ©sabonnements ?",
    faq3_a:
      "Nous incluons la capture du consentement, des flux dâ€™opt-out clairs et respectons les rÃ¨gles rÃ©gionales.",
    faq4_q: "Ã€ quoi ressemble lâ€™onboarding ?",
    faq4_a:
      "Appel stratÃ©gique, workflows dÃ©finis, intÃ©grations connectÃ©es, sÃ©quences lancÃ©esâ€”en 7â€“10 jours typiquement.",
    faq5_q: "Offrez-vous une garantie de remboursement/rÃ©sultats ?",
    faq5_a:
      "Oui. Si nous ne respectons pas les rÃ©sultats convenus lors de lâ€™appel de dÃ©marrage dans les 30 premiers jours (selon les entrÃ©es convenues comme le budget pub, la qualitÃ© des listes, lâ€™emplacement des formulaires), nous ne facturons pas le mois. On corrige ensemble ou on met en pauseâ€”Ã  vous de choisir.",

    // booking
    book_title: "RÃ©server un appel",
    book_p:
      "Choisissez un moment qui vous convient, ou laissez vos infos et nous confirmerons par SMS/email.",
    book_left_h: "Lien direct calendrier",
    book_left_p: "DÃ©jÃ  prÃªt ? Passez directement au calendrier.",
    book_left_btn: "Ouvrir le calendrier",
    book_left_note: "Nous utiliserons votre lien Calendly depuis",
    book_right_h: "Demander une rÃ©servation",

    // form
    form_name: "Nom",
    form_email: "Email",
    form_phone: "TÃ©lÃ©phone",
    form_company: "Entreprise",
    form_notes: "Que souhaitez-vous amÃ©liorer ?",
    form_btn: "Demander un horaire",

    // footer
    footer_tag:
      "Nous rÃ©pondons en quelques secondes et rÃ©servons des appels en pilote automatique.",
    rights: "Tous droits rÃ©servÃ©s."
  }
};

// normalize: treat 'fr', 'FR', 'fr-CA' as French
const isFR = (v) => String(v || "").toLowerCase().startsWith("fr");


// 2) Helper: choose innerHTML only if the string contains markup
const hasHTML = (s) => /<[^>]+>/.test(s);

// 3) Apply language
function applyLang(lang) {
  try {
    const dict = I18N[ isFR(lang) ? "fr" : "en" ] || I18N.en;

    document.querySelectorAll("[data-i18n]").forEach((el) => {
      const key = el.getAttribute("data-i18n");
      const val = dict[key];
      if (val == null) return; // unknown key -> leave as is

      if (hasHTML(val)) el.innerHTML = val;
      else el.textContent = val;
    });

    // ðŸ”‘ update redirect whenever language changes
    setFormRedirect(lang);
    } catch (err) {
    console.error("applyLang error:", err);
  }
}

    // active state + document lang
    document.querySelectorAll(".lang-switch button").forEach((b) => b.classList.remove("active"));
    const btn = document.getElementById("lang-" + lang);
    if (btn) btn.classList.add("active");

    document.documentElement.setAttribute("lang", lang);
    localStorage.setItem("lang", lang);
  } catch (e) {
    console.error("Language switch error:", e);
  }
}

// 4) Wire up once DOM is parsed (defer guarantees this runs before DOMContentLoaded)
document.addEventListener("DOMContentLoaded", () => {
  // safety: sometimes pages are cached â€” bump the year in footer
  const yearEl = document.getElementById("year");
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  const enBtn = document.getElementById("lang-en");
  const frBtn = document.getElementById("lang-fr");

  if (enBtn) enBtn.addEventListener("click", () => applyLang("en"));
  if (frBtn) frBtn.addEventListener("click", () => applyLang("fr"));

  const initial = localStorage.getItem("lang") || "en";
  applyLang(initial);
});

// --- FAQ accordion toggle ---
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".acc__btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const isOpen = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!isOpen));
    });
  });
});

// Set Formspree _redirect based on language
function setFormRedirect(lang) {
  const redir = document.querySelector('form#bookingForm input[name="_redirect"]');
  if (!redir) return;
  // Use absolute URLs (Formspree prefers absolute redirects)
  const base = window.location.origin;
  redir.value = base + (lang === "fr" ? "/merci.html" : "/thank-you.html");
}




